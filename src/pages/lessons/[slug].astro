---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

// 1. Generamos las rutas estáticas
export async function getStaticPaths() {
  const lessons = await getCollection('lessons');
  
  return lessons.map(entry => ({
    params: { slug: entry.slug }, 
    props: { entry },
  }));
}

// 2. Obtenemos los datos para cada página
const { entry } = Astro.props;
const { Content } = await entry.render();
---

<Layout title={`${entry.data.title} - Curso Español`}>
  <main class="min-h-screen bg-slate-50 py-12">
    <article class="max-w-4xl mx-auto bg-white shadow-xl rounded-lg overflow-hidden">
      
      {/* Cabecera con imagen (si existe) o colores de marca */}
      <header class="relative bg-brand-dark text-white p-8 border-b-8 border-brand-green">
        <div class="relative z-10">
          <span class="inline-block bg-brand-yellow text-brand-dark text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider mb-3">
            {entry.data.unit}
          </span>
          <h1 class="text-4xl md:text-5xl font-extrabold tracking-tight mb-2">
            {entry.data.title}
          </h1>
        </div>
        {/* Decoración de fondo */}
        <div class="absolute top-0 right-0 w-32 h-32 bg-brand-blue opacity-10 rounded-bl-full"></div>
      </header>

      {/* Contenido de la lección */}
      <div class="px-8 py-10 md:px-12">
        <div class="prose prose-lg max-w-none 
          prose-headings:text-brand-green 
          prose-h3:text-brand-blue 
          prose-a:text-brand-red prose-a:no-underline hover:prose-a:underline
          prose-strong:text-brand-brown
          prose-li:marker:text-brand-yellow">
          
          <Content />
          
        </div>

        {/* Navegación inferior */}
        <div class="mt-12 pt-8 border-t border-gray-100 flex justify-between items-center">
          <a href="/" class="text-brand-blue font-semibold hover:text-brand-dark transition-colors">
            ← Volver al curso
          </a>
        </div>
      </div>

    </article>
  </main>
</Layout>
